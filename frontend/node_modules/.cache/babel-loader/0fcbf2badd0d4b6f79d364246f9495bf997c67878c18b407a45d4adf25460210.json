{"ast":null,"code":"import{ROLE}from'../constants';import{sessions}from'../sessions';import{deletePost,getComments,deleteComment}from'../api';export const removePost=async(hash,id)=>{const accessRoles=[ROLE.ADMIN];const access=await sessions.access(hash,accessRoles);if(!access){return{error:'Доступ запрещен',res:null};}await deletePost(id);const comments=await getComments(id);await Promise.all(comments.map(_ref=>{let{id:commentId}=_ref;return deleteComment(commentId);}));return{error:null,res:true};};","map":{"version":3,"names":["ROLE","sessions","deletePost","getComments","deleteComment","removePost","hash","id","accessRoles","ADMIN","access","error","res","comments","Promise","all","map","_ref","commentId"],"sources":["/Users/evgeniapodoprigora/Desktop/practice/frontend/src/bff/operations/remove-post.js"],"sourcesContent":["import { ROLE } from '../constants';\nimport { sessions } from '../sessions';\nimport { deletePost, getComments, deleteComment } from '../api';\n\nexport const removePost = async (hash, id) => {\n\tconst accessRoles = [ROLE.ADMIN];\n\n\tconst access = await sessions.access(hash, accessRoles);\n\n\tif (!access) {\n\t\treturn {\n\t\t\terror: 'Доступ запрещен',\n\t\t\tres: null,\n\t\t};\n\t}\n\n\tawait deletePost(id);\n\n\tconst comments = await getComments(id);\n\n\tawait Promise.all(comments.map(({ id: commentId }) => deleteComment(commentId)));\n\n\treturn {\n\t\terror: null,\n\t\tres: true,\n\t};\n};\n"],"mappings":"AAAA,OAASA,IAAI,KAAQ,cAAc,CACnC,OAASC,QAAQ,KAAQ,aAAa,CACtC,OAASC,UAAU,CAAEC,WAAW,CAAEC,aAAa,KAAQ,QAAQ,CAE/D,MAAO,MAAM,CAAAC,UAAU,CAAG,KAAAA,CAAOC,IAAI,CAAEC,EAAE,GAAK,CAC7C,KAAM,CAAAC,WAAW,CAAG,CAACR,IAAI,CAACS,KAAK,CAAC,CAEhC,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAT,QAAQ,CAACS,MAAM,CAACJ,IAAI,CAAEE,WAAW,CAAC,CAEvD,GAAI,CAACE,MAAM,CAAE,CACZ,MAAO,CACNC,KAAK,CAAE,iBAAiB,CACxBC,GAAG,CAAE,IACN,CAAC,CACF,CAEA,KAAM,CAAAV,UAAU,CAACK,EAAE,CAAC,CAEpB,KAAM,CAAAM,QAAQ,CAAG,KAAM,CAAAV,WAAW,CAACI,EAAE,CAAC,CAEtC,KAAM,CAAAO,OAAO,CAACC,GAAG,CAACF,QAAQ,CAACG,GAAG,CAACC,IAAA,MAAC,CAAEV,EAAE,CAAEW,SAAU,CAAC,CAAAD,IAAA,OAAK,CAAAb,aAAa,CAACc,SAAS,CAAC,GAAC,CAAC,CAEhF,MAAO,CACNP,KAAK,CAAE,IAAI,CACXC,GAAG,CAAE,IACN,CAAC,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}