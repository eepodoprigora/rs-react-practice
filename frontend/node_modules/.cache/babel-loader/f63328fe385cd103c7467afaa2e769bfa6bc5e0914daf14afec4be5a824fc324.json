{"ast":null,"code":"import{useEffect,useMemo,useState}from'react';import{useServerRequest}from'../../hooks';import{PostCard,Pagination,Search}from'./components';import{PAGINATION_LIMIT}from'../../constants';import styled from'styled-components';import{debounce}from'./utils';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MainContainer=_ref=>{let{className}=_ref;const requestServer=useServerRequest();const[posts,setPosts]=useState([]);const[page,setPage]=useState(1);const[lastPage,setLastPage]=useState(1);const[shouldSearch,setShouldSearch]=useState(false);const[searchPhrase,setSearchPhrase]=useState('');useEffect(()=>{requestServer('fetchPosts',searchPhrase,page,PAGINATION_LIMIT).then(posts=>{setPosts(posts.res);setLastPage(posts.lastPage);});// eslint-disable-next-line\n},[requestServer,page,shouldSearch]);const startDelayedSearh=useMemo(()=>debounce(setShouldSearch,2000),[]);const onSearch=_ref2=>{let{target}=_ref2;setSearchPhrase(target.value);startDelayedSearh(!shouldSearch);};return/*#__PURE__*/_jsxs(\"div\",{className:className,children:[/*#__PURE__*/_jsx(Search,{onChange:onSearch,searchPhrase:searchPhrase}),posts.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"post-list\",children:posts.map(_ref3=>{let{id,title,publishedAt,commentsCount,imageUrl}=_ref3;return/*#__PURE__*/_jsx(PostCard,{id:id,title:title,publishedAt:publishedAt,imageUrl:imageUrl,commentsCount:commentsCount},id);})}):/*#__PURE__*/_jsx(\"div\",{className:\"not-found-posts\",children:\"\\u041D\\u0438\\u0447\\u0435\\u0433\\u043E \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E\"}),posts.length>0&&lastPage>1&&/*#__PURE__*/_jsx(Pagination,{page:page,lastPage:lastPage,setPage:setPage})]});};export const Main=styled(MainContainer)`\n\t.post-list {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 40px;\n\t\tpadding: 0 40px;\n\t}\n\n\t.not-found-posts {\n\t\ttext-align: center;\n\t\tfont-size: 18px;\n\t}\n`;","map":{"version":3,"names":["useEffect","useMemo","useState","useServerRequest","PostCard","Pagination","Search","PAGINATION_LIMIT","styled","debounce","jsx","_jsx","jsxs","_jsxs","MainContainer","_ref","className","requestServer","posts","setPosts","page","setPage","lastPage","setLastPage","shouldSearch","setShouldSearch","searchPhrase","setSearchPhrase","then","res","startDelayedSearh","onSearch","_ref2","target","value","children","onChange","length","map","_ref3","id","title","publishedAt","commentsCount","imageUrl","Main"],"sources":["/Users/evgeniapodoprigora/Desktop/practice/frontend/src/pages/main/main.js"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\n\nimport { useServerRequest } from '../../hooks';\nimport { PostCard, Pagination, Search } from './components';\nimport { PAGINATION_LIMIT } from '../../constants';\n\nimport styled from 'styled-components';\nimport { debounce } from './utils';\n\nconst MainContainer = ({ className }) => {\n\tconst requestServer = useServerRequest();\n\tconst [posts, setPosts] = useState([]);\n\tconst [page, setPage] = useState(1);\n\tconst [lastPage, setLastPage] = useState(1);\n\tconst [shouldSearch, setShouldSearch] = useState(false);\n\tconst [searchPhrase, setSearchPhrase] = useState('');\n\n\tuseEffect(() => {\n\t\trequestServer('fetchPosts', searchPhrase, page, PAGINATION_LIMIT).then(\n\t\t\t(posts) => {\n\t\t\t\tsetPosts(posts.res);\n\t\t\t\tsetLastPage(posts.lastPage);\n\t\t\t},\n\t\t);\n\n\t\t// eslint-disable-next-line\n\t}, [requestServer, page, shouldSearch]);\n\n\tconst startDelayedSearh = useMemo(() => debounce(setShouldSearch, 2000), []);\n\n\tconst onSearch = ({ target }) => {\n\t\tsetSearchPhrase(target.value);\n\t\tstartDelayedSearh(!shouldSearch);\n\t};\n\n\treturn (\n\t\t<div className={className}>\n\t\t\t<Search onChange={onSearch} searchPhrase={searchPhrase} />\n\n\t\t\t{posts.length > 0 ? (\n\t\t\t\t<div className=\"post-list\">\n\t\t\t\t\t{posts.map(({ id, title, publishedAt, commentsCount, imageUrl }) => (\n\t\t\t\t\t\t<PostCard\n\t\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\ttitle={title}\n\t\t\t\t\t\t\tpublishedAt={publishedAt}\n\t\t\t\t\t\t\timageUrl={imageUrl}\n\t\t\t\t\t\t\tcommentsCount={commentsCount}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<div className=\"not-found-posts\">Ничего не найдено</div>\n\t\t\t)}\n\n\t\t\t{posts.length > 0 && lastPage > 1 && (\n\t\t\t\t<Pagination page={page} lastPage={lastPage} setPage={setPage} />\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport const Main = styled(MainContainer)`\n\t.post-list {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 40px;\n\t\tpadding: 0 40px;\n\t}\n\n\t.not-found-posts {\n\t\ttext-align: center;\n\t\tfont-size: 18px;\n\t}\n`;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}