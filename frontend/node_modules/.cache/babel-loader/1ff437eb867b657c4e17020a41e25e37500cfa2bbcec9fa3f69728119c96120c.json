{"ast":null,"code":"import{useNavigate}from'react-router-dom';import{useLayoutEffect,useRef,useState}from'react';import{useDispatch}from'react-redux';import{Input,Icon}from'../../../../components';import{SpecialPanel}from'../special-panel/special-panel';import{sanitizeContent}from'./utils';import{savePostAsync}from'../../../../actions';import{useServerRequest}from'../../../../hooks';import styled from'styled-components';import{PROP_TYPE}from'../../../../constants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PostFormContainer=_ref=>{let{className,post:{id,title,imageUrl,content,publishedAt}}=_ref;const[imageUrlValue,setImageUrlValue]=useState(imageUrl);const[titlelValue,setTitleValue]=useState(title);const contentRef=useRef(null);const dispatch=useDispatch();const navigate=useNavigate();const requestServer=useServerRequest();useLayoutEffect(()=>{setImageUrlValue(imageUrl);setTitleValue(title);},[title,imageUrl]);const onSave=()=>{const newContent=sanitizeContent(contentRef.current.innerHTML);dispatch(savePostAsync(requestServer,{id:id,imageUrl:imageUrlValue,title:titlelValue,content:newContent})).then(_ref2=>{let{id}=_ref2;return navigate(`/post/${id}`);});};const onImageChange=_ref3=>{let{target}=_ref3;return setImageUrlValue(target.value);};const onTitleChange=_ref4=>{let{target}=_ref4;return setTitleValue(target.value);};return/*#__PURE__*/_jsxs(\"div\",{className:className,children:[/*#__PURE__*/_jsx(Input,{value:imageUrlValue,placeholder:\"\\u0418\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435...\",onChange:onImageChange}),/*#__PURE__*/_jsx(Input,{value:titlelValue,placeholder:\"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A...\",onChange:onTitleChange}),/*#__PURE__*/_jsx(SpecialPanel,{id:id,publishedAt:publishedAt,margin:\"20px 0\",editButton:/*#__PURE__*/_jsx(Icon,{id:\"fa-floppy-o\",margin:\"0 12px 0 0\",size:\"20px\",onClick:onSave})}),/*#__PURE__*/_jsx(\"div\",{ref:contentRef,contentEditable:true,suppressContentEditableWarning:true,className:\"post-text\",children:content})]});};export const PostForm=styled(PostFormContainer)`\n\timg {\n\t\tfloat: left;\n\t\tmargin: 0 40px 10px 0;\n\t}\n\n\t.post-text {\n\t\twhite-space: pre-line;\n\t\tmin-height: 80px;\n\t\tborder: 1px solid #000;\n\t}\n`;PostForm.propTypes={post:PROP_TYPE.POST};","map":{"version":3,"names":["useNavigate","useLayoutEffect","useRef","useState","useDispatch","Input","Icon","SpecialPanel","sanitizeContent","savePostAsync","useServerRequest","styled","PROP_TYPE","jsx","_jsx","jsxs","_jsxs","PostFormContainer","_ref","className","post","id","title","imageUrl","content","publishedAt","imageUrlValue","setImageUrlValue","titlelValue","setTitleValue","contentRef","dispatch","navigate","requestServer","onSave","newContent","current","innerHTML","then","_ref2","onImageChange","_ref3","target","value","onTitleChange","_ref4","children","placeholder","onChange","margin","editButton","size","onClick","ref","contentEditable","suppressContentEditableWarning","PostForm","propTypes","POST"],"sources":["/Users/evgeniapodoprigora/Desktop/practice/frontend/src/pages/post/components/post-form/post-form.js"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\nimport { useLayoutEffect, useRef, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { Input, Icon } from '../../../../components';\nimport { SpecialPanel } from '../special-panel/special-panel';\nimport { sanitizeContent } from './utils';\nimport { savePostAsync } from '../../../../actions';\nimport { useServerRequest } from '../../../../hooks';\n\nimport styled from 'styled-components';\nimport { PROP_TYPE } from '../../../../constants';\n\nconst PostFormContainer = ({\n\tclassName,\n\tpost: { id, title, imageUrl, content, publishedAt },\n}) => {\n\tconst [imageUrlValue, setImageUrlValue] = useState(imageUrl);\n\tconst [titlelValue, setTitleValue] = useState(title);\n\n\tconst contentRef = useRef(null);\n\n\tconst dispatch = useDispatch();\n\tconst navigate = useNavigate();\n\n\tconst requestServer = useServerRequest();\n\n\tuseLayoutEffect(() => {\n\t\tsetImageUrlValue(imageUrl);\n\t\tsetTitleValue(title);\n\t}, [title, imageUrl]);\n\n\tconst onSave = () => {\n\t\tconst newContent = sanitizeContent(contentRef.current.innerHTML);\n\n\t\tdispatch(\n\t\t\tsavePostAsync(requestServer, {\n\t\t\t\tid: id,\n\t\t\t\timageUrl: imageUrlValue,\n\t\t\t\ttitle: titlelValue,\n\t\t\t\tcontent: newContent,\n\t\t\t}),\n\t\t).then(({ id }) => navigate(`/post/${id}`));\n\t};\n\n\tconst onImageChange = ({ target }) => setImageUrlValue(target.value);\n\tconst onTitleChange = ({ target }) => setTitleValue(target.value);\n\n\treturn (\n\t\t<div className={className}>\n\t\t\t<Input\n\t\t\t\tvalue={imageUrlValue}\n\t\t\t\tplaceholder=\"Изображение...\"\n\t\t\t\tonChange={onImageChange}\n\t\t\t/>\n\t\t\t<Input\n\t\t\t\tvalue={titlelValue}\n\t\t\t\tplaceholder=\"Заголовок...\"\n\t\t\t\tonChange={onTitleChange}\n\t\t\t/>\n\t\t\t<SpecialPanel\n\t\t\t\tid={id}\n\t\t\t\tpublishedAt={publishedAt}\n\t\t\t\tmargin=\"20px 0\"\n\t\t\t\teditButton={\n\t\t\t\t\t<Icon\n\t\t\t\t\t\tid=\"fa-floppy-o\"\n\t\t\t\t\t\tmargin=\"0 12px 0 0\"\n\t\t\t\t\t\tsize=\"20px\"\n\t\t\t\t\t\tonClick={onSave}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tref={contentRef}\n\t\t\t\tcontentEditable={true}\n\t\t\t\tsuppressContentEditableWarning={true}\n\t\t\t\tclassName=\"post-text\"\n\t\t\t>\n\t\t\t\t{content}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport const PostForm = styled(PostFormContainer)`\n\timg {\n\t\tfloat: left;\n\t\tmargin: 0 40px 10px 0;\n\t}\n\n\t.post-text {\n\t\twhite-space: pre-line;\n\t\tmin-height: 80px;\n\t\tborder: 1px solid #000;\n\t}\n`;\n\nPostForm.propTypes = {\n\tpost: PROP_TYPE.POST,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}