{"ast":null,"code":"import{useEffect,useLayoutEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{useMatch,useParams}from'react-router-dom';import{Comments,PostContent,PostForm}from'./components';import{useServerRequest}from'../../hooks';import{loadPostAsync,RESET_POST_DATA}from'../../actions';import{selectPost}from'../../selectors/select-post';import{Error,PrivateContent}from'../../components';import styled from'styled-components';import{ROLE}from'../../constants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PostContainer=_ref=>{let{className}=_ref;const post=useSelector(selectPost);const dispatch=useDispatch();const params=useParams();const requestServer=useServerRequest();const isCreating=!!useMatch('/post/');const isEditing=!!useMatch('/post/:id/edit');const[error,setError]=useState(null);const[isLoading,setIsLoading]=useState(true);useLayoutEffect(()=>{dispatch(RESET_POST_DATA);},[dispatch,isCreating]);useEffect(()=>{if(isCreating){setIsLoading(false);return;}dispatch(loadPostAsync(requestServer,params.id)).then(postData=>{setError(postData.error);setIsLoading(false);});},[dispatch,requestServer,params.id,isCreating]);if(isLoading)return null;const SpecificPostPage=isCreating||isEditing?/*#__PURE__*/_jsx(PrivateContent,{access:[ROLE.ADMIN],serverError:error,children:/*#__PURE__*/_jsx(\"div\",{className:className,children:/*#__PURE__*/_jsx(PostForm,{post:post})})}):/*#__PURE__*/_jsxs(\"div\",{className:className,children:[/*#__PURE__*/_jsx(PostContent,{post:post}),/*#__PURE__*/_jsx(Comments,{comments:post.comments,postId:post.id})]});return error?/*#__PURE__*/_jsx(Error,{error:error}):SpecificPostPage;};export const Post=styled(PostContainer)`\n\tmargin-top: 40px;\n\tpadding: 0 80px;\n`;","map":{"version":3,"names":["useEffect","useLayoutEffect","useState","useDispatch","useSelector","useMatch","useParams","Comments","PostContent","PostForm","useServerRequest","loadPostAsync","RESET_POST_DATA","selectPost","Error","PrivateContent","styled","ROLE","jsx","_jsx","jsxs","_jsxs","PostContainer","_ref","className","post","dispatch","params","requestServer","isCreating","isEditing","error","setError","isLoading","setIsLoading","id","then","postData","SpecificPostPage","access","ADMIN","serverError","children","comments","postId","Post"],"sources":["/Users/evgeniapodoprigora/Desktop/practice/frontend/src/pages/post/post.js"],"sourcesContent":["import { useEffect, useLayoutEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useMatch, useParams } from 'react-router-dom';\n\nimport { Comments, PostContent, PostForm } from './components';\nimport { useServerRequest } from '../../hooks';\nimport { loadPostAsync, RESET_POST_DATA } from '../../actions';\nimport { selectPost } from '../../selectors/select-post';\nimport { Error, PrivateContent } from '../../components';\n\nimport styled from 'styled-components';\nimport { ROLE } from '../../constants';\n\nconst PostContainer = ({ className }) => {\n\tconst post = useSelector(selectPost);\n\tconst dispatch = useDispatch();\n\tconst params = useParams();\n\tconst requestServer = useServerRequest();\n\tconst isCreating = !!useMatch('/post/');\n\tconst isEditing = !!useMatch('/post/:id/edit');\n\n\tconst [error, setError] = useState(null);\n\tconst [isLoading, setIsLoading] = useState(true);\n\n\tuseLayoutEffect(() => {\n\t\tdispatch(RESET_POST_DATA);\n\t}, [dispatch, isCreating]);\n\n\tuseEffect(() => {\n\t\tif (isCreating) {\n\t\t\tsetIsLoading(false);\n\t\t\treturn;\n\t\t}\n\t\tdispatch(loadPostAsync(requestServer, params.id)).then((postData) => {\n\t\t\tsetError(postData.error);\n\t\t\tsetIsLoading(false);\n\t\t});\n\t}, [dispatch, requestServer, params.id, isCreating]);\n\n\tif (isLoading) return null;\n\n\tconst SpecificPostPage =\n\t\tisCreating || isEditing ? (\n\t\t\t<PrivateContent access={[ROLE.ADMIN]} serverError={error}>\n\t\t\t\t<div className={className}>\n\t\t\t\t\t<PostForm post={post} />\n\t\t\t\t</div>\n\t\t\t</PrivateContent>\n\t\t) : (\n\t\t\t<div className={className}>\n\t\t\t\t<PostContent post={post} />\n\t\t\t\t<Comments comments={post.comments} postId={post.id} />\n\t\t\t</div>\n\t\t);\n\n\treturn error ? <Error error={error}></Error> : SpecificPostPage;\n};\n\nexport const Post = styled(PostContainer)`\n\tmargin-top: 40px;\n\tpadding: 0 80px;\n`;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}